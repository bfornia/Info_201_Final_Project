# Create a main panel, in which you should display your plotly Scatter plot
mainPanel(
plotOutput(outputId = "scatter")
))))))
# Define `ui` variable
shinyUI(navbarPage("Poverty in the Midwest", tabPanel(
"Scatter",
# Add a titlePanel to your tab
titlePanel("Percent White vs. Percent Below Poverty per State"),
# Create a sidebar layout for this tab (page)
sidebarLayout(sidebarPanel(
# Make a textInput widget for searching for a state in your scatter plot
selectInput(inputId = "feature",
label = "Choose a State",
choices = values[12:16])
),
# Create a main panel, in which you should display your plotly Scatter plot
mainPanel(
plotOutput(outputId = "scatter")
)))))
runApp('C:/Users/MacKenzie/Desktop/Info201/a8-mhwood22')
# Build scatter plot file
build_scatter <- function(data, search = "", xvar = input$feature, yvar = "poptotal") {
xmax <- max(data[, xvar]) * 1.2
ymax <- max(data[, yvar]) * 1.2
# create plot
ggplot(data = midwest, mapping = aes_string(x = data[, xvar], y = data[, yvar], color = "blue")) +
geompoint() %>%
layout(xaxis = list(range = c(0, xmax), title = "Total Population in County"),
yaxis = list(range = c(0, ymax), title = "Percent of Population")) %>%
return()
}
runApp('C:/Users/MacKenzie/Desktop/Info201/a8-mhwood22')
shiny::runApp('C:/Users/MacKenzie/Desktop/Info201/a8-mhwood22')
shiny::runApp('C:/Users/MacKenzie/Desktop/Info201/Info_201_Final_Project')
setwd("C:/Users/MacKenzie/Desktop/Info201/Info_201_Final_Project")
source("scripts/degree_comparison.R")
source("scripts/degree_comparison.R")
source("scripts/degree_comparison.R")
data <- read.csv("data/degrees-that-pay-back.csv", stringsAsFactors = FALSE)
source("scripts/degree_comparison.R")
# to use this function, a vector of different majors must be inputted
degree_comparison <- function(degrees) {
# helper code: https://stackoverflow.com/questions/31944103/convert-currency-with-commas-into-numeric
data_one <- data %>%
filter(Undergraduate.Major %in% degrees) %>%
mutate(
starting = as.numeric(gsub("[$,]", "", Starting.Median.Salary)),
mid_median = as.numeric(gsub("[$,]", "", Mid.Career.Median.Salary)),
mid_10th = as.numeric(gsub("[$,]", "",
Mid.Career.10th.Percentile.Salary)),
mid_25th = as.numeric(gsub("[$,]", "",
Mid.Career.25th.Percentile.Salary)),
mid_75th = as.numeric(gsub("[$,]", "",
Mid.Career.75th.Percentile.Salary)),
mid_90th = as.numeric(gsub("[$,]", "",
Mid.Career.90th.Percentile.Salary))
) %>%
select(-Starting.Median.Salary, -Mid.Career.Median.Salary,
-Mid.Career.10th.Percentile.Salary,
-Mid.Career.25th.Percentile.Salary,
-Mid.Career.75th.Percentile.Salary,
-Mid.Career.90th.Percentile.Salary)
salary_plot <- plot_ly(
data = data_one,
x = ~Undergraduate.Major,
y = ~starting,
name = "Starting Median",
type = "bar"
) %>%
add_trace(
y = ~mid_median,
name = "Mid-Career Median"
) %>%
add_trace(
y = ~mid_10th,
name = "Mid-Career 10th Percentile"
) %>%
add_trace(
y = ~mid_25th,
name = "Mid-Career 25th Percentile"
) %>%
add_trace(
y = ~mid_75th,
name = "Mid-Career 75th Percentile"
) %>%
add_trace(
y = ~mid_90th,
name = "Mid-Career 90th Percentile"
) %>%
layout(
xaxis = list(title = "Degree"),
yaxis = list(title = "Salary"),
barmode = "group"
)
salary_plot
}
source("scripts/degree_comparison.R")
library(plotly)
source("scripts/degree_comparison.R")
source("scripts/degree_comparison.R")
View(data)
library(ggplot2)
source("regional_analysis.R")
library("dplyr")
#Load in data
regional_data <- read.csv("data/salaries-by-region.csv", stringsAsFactors = FALSE)
#Taking each region separately
unique(regional_data$Region)
california_data <- regional_data %>%
filter(Region == "California")
western_data <- regional_data %>%
filter(Region == "Western")
midwestern_data <- regional_data %>%
filter(Region == "Midwestern")
southern_data <- regional_data %>%
filter(Region == "Southern")
northeastern_data <- regional_data %>%
filter(Region == "Northeastern")
#California Analysis
#Convert "N/A" to NA
california_data[california_data == "N/A"] <- NA
#Get mean for all columns
get_mean_10th(california_data)
get_mean_25th(california_data)
get_mean_start <- function(dataframe){
column <- (gsub(
"\\$",
"",
dataframe$Starting.Median.Salary))
column <- as.numeric(gsub(",", "", column, fixed = TRUE))
mean(column, na.rm = TRUE)
}
#Gets mean of the midcareer columm
get_mean_median <- function(dataframe){
column <- (gsub(
"\\$",
"",
dataframe$Mid.Career.Median.Salary))
column <- as.numeric(gsub(",", "", column, fixed = TRUE))
mean(column, na.rm = TRUE)
}
#Gets mean of the 10th percentile columm
get_mean_10th <- function(dataframe){
column <- (gsub(
"\\$",
"",
dataframe$Mid.Career.10th.Percentile.Salary))
column <- as.numeric(gsub(",", "", column, fixed = TRUE))
mean(column, na.rm = TRUE)
}
#Gets mean of the 25th percentile columm
get_mean_25th <- function(dataframe){
column <- (gsub(
"\\$",
"",
dataframe$Mid.Career.25th.Percentile.Salary))
column <- as.numeric(gsub(",", "", column, fixed = TRUE))
mean(column, na.rm = TRUE)
}
#Gets mean of the 75th percentile columm
get_mean_75th <- function(dataframe){
column <- (gsub(
"\\$",
"",
dataframe$Mid.Career.75th.Percentile.Salary))
column <- as.numeric(gsub(",", "", column, fixed = TRUE))
mean(column, na.rm = TRUE)
}
#Gets mean of the 90th percentile column
get_mean_90th <- function(dataframe){
column <- (gsub(
"\\$",
"",
dataframe$Mid.Career.90th.Percentile.Salary))
column <- as.numeric(gsub(",", "", column, fixed = TRUE))
mean(column, na.rm = TRUE)
}
column <- (gsub(
"\\$",
"",
dataframe$Mid.Career.75th.Percentile.Salary))
library("dplyr")
#Load in data
regional_data <- read.csv("data/salaries-by-region.csv", stringsAsFactors = FALSE)
#Taking each region separately
unique(regional_data$Region)
california_data <- regional_data %>%
filter(Region == "California")
western_data <- regional_data %>%
filter(Region == "Western")
midwestern_data <- regional_data %>%
filter(Region == "Midwestern")
southern_data <- regional_data %>%
filter(Region == "Southern")
northeastern_data <- regional_data %>%
filter(Region == "Northeastern")
#California Analysis
#Convert "N/A" to NA
california_data[california_data == "N/A"] <- NA
#Get mean for all columns
get_mean_10th(california_data)
get_mean_25th(california_data)
get_mean_75th(california_data)
get_mean_90th(california_data)
get_mean_median(california_data)
get_mean_start(california_data)
#Western Analysis
#Convert "N/A" to NA
western_data[western_data == "N/A"] <- NA
#Get mean for all columns
get_mean_10th(western_data)
get_mean_25th(western_data)
get_mean_75th(western_data)
get_mean_90th(western_data)
get_mean_median(western_data)
get_mean_start(western_data)
#Midwest Analysis
#Convert "N/A" to NA
midwestern_data[midwestern_data == "N/A"] <- NA
#Get mean for all columns
get_mean_10th(midwestern_data)
get_mean_25th(midwestern_data)
get_mean_75th(midwestern_data)
get_mean_90th(midwestern_data)
get_mean_median(midwestern_data)
get_mean_start(midwestern_data)
#Southern Analysis
#Convert "N/A" to NA
southern_data[southern_data == "N/A"] <- NA
#Get mean for all columns
get_mean_10th(southern_data)
get_mean_25th(southern_data)
get_mean_75th(southern_data)
get_mean_90th(southern_data)
get_mean_median(southern_data)
get_mean_start(southern_data)
#Northeastern analysis
#Convert "N/A" to NA
northeastern_data[northeastern_data == "N/A"] <- NA
#Get mean for all columns
get_mean_10th(northeastern_data)
get_mean_25th(northeastern_data)
get_mean_75th(northeastern_data)
get_mean_90th(northeastern_data)
get_mean_median(northeastern_data)
get_mean_start(northeastern_data)
#Create Dataframe
Region <- c("California", "West", "Midwest", "South", "Northeast")
Mean_10th_Percentile <- c(get_mean_10th(california_data),
get_mean_10th(western_data),
get_mean_10th(midwestern_data),
get_mean_10th(southern_data),
get_mean_10th(northeastern_data))
Mean_25th_Percentile <- c(get_mean_25th(california_data),
get_mean_25th(western_data),
get_mean_25th(midwestern_data),
get_mean_25th(southern_data),
get_mean_25th(northeastern_data))
Mean_75th_Percentile <- c(get_mean_75th(california_data),
get_mean_75th(western_data),
get_mean_75th(midwestern_data),
get_mean_75th(southern_data),
get_mean_75th(northeastern_data))
Mean_90th_Percentile <- c(get_mean_90th(california_data),
get_mean_90th(western_data),
get_mean_90th(midwestern_data),
get_mean_90th(southern_data),
get_mean_90th(northeastern_data))
Mean_MidCareer_Median <- c(get_mean_median(california_data),
get_mean_median(western_data),
get_mean_median(midwestern_data),
get_mean_median(southern_data),
get_mean_median(northeastern_data))
Mean_Starting <- c(get_mean_start(california_data),
get_mean_start(western_data),
get_mean_start(midwestern_data),
get_mean_start(southern_data),
get_mean_start(northeastern_data))
regional_data <- data.frame(Region,
Mean_10th_Percentile,
Mean_25th_Percentile,
Mean_75th_Percentile,
Mean_90th_Percentile,
Mean_MidCareer_Median,
Mean_Starting)
choices_holder <- regional_data
choices_holder$Region <- NULL
choices <- colnames(choices_holder)
#Find school with highest starting
max_start <- function(dataframe){
data <- dataframe %>%
filter(Starting.Median.Salary == max(Starting.Median.Salary)) %>%
select(School.Name)
}
max_cali_start <- max_start(california_data)
max_west_start <- max_start(western_data)
max_midwest_start <- max_start(midwestern_data)
max_south_start <- max_start(southern_data)
max_northeast_start <- max_start(northeastern_data)
Highest_Starting_Salary <- c(max_cali_start,
max_west_start,
max_midwest_start,
max_south_start,
max_northeast_start)
#Find school with highest midcareer
max_mid <- function(dataframe){
data <- dataframe %>%
filter(Mid.Career.Median.Salary == max(Mid.Career.Median.Salary)) %>%
select(School.Name)
}
max_cali_mid <- max_mid(california_data)
max_west_mid <- max_mid(western_data)
max_midwest_mid <- max_mid(midwestern_data)
max_south_mid <- "Rice University"
max_northeast_mid <- max_mid(northeastern_data)
Highest_MidCareer_Salary <- c(max_cali_mid,
max_west_mid,
max_midwest_mid,
max_south_mid,
max_northeast_mid)
#Functions:
#Gets mean of the start columm
get_mean_start <- function(dataframe){
column <- (gsub(
"\\$",
"",
dataframe$Starting.Median.Salary))
column <- as.numeric(gsub(",", "", column, fixed = TRUE))
mean(column, na.rm = TRUE)
}
#Gets mean of the midcareer columm
get_mean_median <- function(dataframe){
column <- (gsub(
"\\$",
"",
dataframe$Mid.Career.Median.Salary))
column <- as.numeric(gsub(",", "", column, fixed = TRUE))
mean(column, na.rm = TRUE)
}
#Gets mean of the 10th percentile columm
get_mean_10th <- function(dataframe){
column <- (gsub(
"\\$",
"",
dataframe$Mid.Career.10th.Percentile.Salary))
column <- as.numeric(gsub(",", "", column, fixed = TRUE))
mean(column, na.rm = TRUE)
}
#Gets mean of the 25th percentile columm
get_mean_25th <- function(dataframe){
column <- (gsub(
"\\$",
"",
dataframe$Mid.Career.25th.Percentile.Salary))
column <- as.numeric(gsub(",", "", column, fixed = TRUE))
mean(column, na.rm = TRUE)
}
#Gets mean of the 75th percentile columm
get_mean_75th <- function(dataframe){
column <- (gsub(
"\\$",
"",
dataframe$Mid.Career.75th.Percentile.Salary))
column <- as.numeric(gsub(",", "", column, fixed = TRUE))
mean(column, na.rm = TRUE)
}
#Gets mean of the 90th percentile column
get_mean_90th <- function(dataframe){
column <- (gsub(
"\\$",
"",
dataframe$Mid.Career.90th.Percentile.Salary))
column <- as.numeric(gsub(",", "", column, fixed = TRUE))
mean(column, na.rm = TRUE)
}
source("regional_analysis.R")
source("scripts/degree_comparison.R")
source("scripts/degree_comparison.R")
source("regional_analysis.R")
shiny::runApp()
library(shiny); runApp('ben.app.R')
runApp()
runApp()
runApp()
runApp('Louis.app.R')
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
setwd("~/Desktop/Info201/homework/Info_201_Final_Project")
library(dplyr)
library(shiny)
library(plotly)
library(ggplot2)
source("scripts/degree_comparison.R")
source("regional_analysis.R")
source("scripts/make_type_aggregate.R")
#Define Options for SelectInput in Type Comparison Bar Chart
salary_options <-
colnames(type_aggregate)[2:(length(colnames(type_aggregate)))]
school_options <- pull(type_aggregate, School.Type)
# Define UI
shinyUI(navbarPage("Compare Universities",
tabPanel("Introduction",
mainPanel(
h1("Where does it pay to go to school?"),
p("THe big question we are asking here is, ", em("where does it pay to go to school?"),
" We break down this question by asking questions about different regions in the US,
different academic majors, and different types of universities (liberal, Ivy, state, etc.).
You will be able to take a look at and compare post-graduation salary information based on
college type, region, and academic major."),
p("On this website we are using data from The Wall Street Journal that provides
information about universities in the US and the average salaries people receive from
each university. Using this information, students, parents, and current university
students can gain information in order to make a more informed decision about majors
you want to pursue and the university/type of university you might be interested in attending."),
img(src = "imgs/spu_fall.jpg"),
p("This page is created for the Info 201 Final Project."),
h4("Created by Damita Gomez, Louis Ta, Benjamin Fornia, and MacKenzie Wood.")
)),
tabPanel("Academic Majors",
titlePanel("Compare Different Academic Majors"),
# Sidebar with a slider input for number of bins
sidebarLayout(
sidebarPanel(
checkboxGroupInput(
"degrees",
label = "Select a degree:",
choices = data$Undergraduate.Major,
selected = "Agriculture"
)
),
# Show a plot of the generated distribution
mainPanel(
p("On this page, you have the option to compare different different majors based on the
starting salary averages, the mid-career salary average, the 10th percentile mid-career
salary and the 90th percentile mid-career salary.  Based on this information, you will
recognize that initial starting salary is not always indicative of mid-career salary.
Also, take into account that this data does not consider that those pursuing certain majors
may be more inclined to attend graduate school which would increase their salary and may
impact the mid-career salary average."),
plotlyOutput("salary_plot")
))),
tabPanel(
"Regional Data",
titlePanel("How Does Salary Vary Between Region of Colleges?"),
sidebarLayout(
selectInput(
"percentiles",
label = "Different Percentiles",
choices = choices,
selected = "Mean_10th_Percentile"
),
mainPanel(
plotOutput("plot"),
p("This page aims to ...")
))),
tabPanel("College Types",
titlePanel("How Does Salary Vary Between Different Types of Colleges?"),
sidebarLayout(
sidebarPanel(
selectInput("school_1", h3("Select First School Type"),
choices = school_options),
selectInput("school_2", h3("Select Second School Type"),
choices = school_options,
selected = school_options[2]),
selectInput("bar_type", h3("Select Salary Type to Compare"),
choices = salary_options)
),
mainPanel(
p("On this page, you have the option to compare two different types of schools based on the
starting salary averages, the mid-career salary average, the 10th percentile mid-career
salary and the 90th percentile mid-career salary.  Based on this information, you can see
how salaries over time are less impacted by school type, especially at higher percentiles.
Also, take into account that this data does not consider that those pursuing certain majors
may be more inclined to attend graduate school which would increase their salary and may
impact the mid-career salary average."),
plotOutput("plot_school_type")
)
))))
library(shiny)
shinyServer(function(input, output){
output$plot <- renderPlot({
data <- regional_data
p <- ggplot(data = data, mapping = aes_string(x = "Region", y = input$percentiles, group =1, color = "Region")) +
geom_line(size = 2) +
geom_point(size = 5)
p
})
output$salary_plot <- renderPlotly({
degree_comparison(input$degrees)
})
output$plot_school_type <- renderPlot({
filtered <- type_aggregate %>%
filter(School.Type %in% c(input$school_1, input$school_2)) %>%
select(School.Type, input$bar_type)
ggplot(data = filtered, aes(x = School.Type,
y = pull(filtered, input$bar_type),
fill = School.Type)) +
geom_bar(stat = "identity") +
ylab(input$bar_type)
})
})
runApp()
runApp()
library(plotly)
install.packages(plotly)
install.packages("plotly")
runApp()
